# Mutex
Mutex(Mutal exclusion 互斥体)

## 底层结构
1. state int32：互斥锁的状态，模式，等待队列长度，对此值进行原子操作来进行加解锁操作
2. sema uint32：信号量，用于等待队列，FIFO
由于结构简单，所以不需要额外的初始化操作，此结构的零值即为一个有效的互斥锁

## 加锁过程
1. G在尝试加锁时，会先进行几次自旋操作(多核&&GOMAXPROCS>1&&至少有一个其他P正在running&&当前P的本地队列不为空)
2. 自旋操作后仍无法获得锁，则通过信号量排队等待，顺序先入先出
3. 当锁释放后，G仍需要与正在自旋阶段的其他G竞争锁
4. 如果G竞争失败，将会被插入队列头部，而不是尾部

## 饥饿模式
当某个G等待时间超过1ms后，将会把Mutex从正常模式切换成饥饿模式。饥饿模式下当有G释放锁时，将直接让队列头上的G持有锁，而不是竞争。后来G将直接进入等待队列。  
当某个G获得锁时，它会在以下情况将Mutex切换成正常模式
1. 该G等待时间小于1ms
2. 等待队列中无其他G