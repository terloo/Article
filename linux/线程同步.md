# 线程同步

1. #### 互斥量（锁）
   
   1. 定义
      
      互斥量是一种多线程同步的变量，互斥量会在一个进程对一个临界资源进行操作时，阻止另一个进程对该临界资源进行操作。保证了关机指令的原子性。又称为互斥锁。
   
   2. 解锁
      
      临界资源未被进程使用，处于解锁状态
   
   3. 加锁
      
      临界资源正被某个进程所使用，处于加锁状态，解锁和加锁可以保证资源访问的串行。

2. #### 自旋锁
   
   1. 定义
      
      与互斥量类似，都是对临界资源加锁来实现线程同步。但是使用了自旋锁的线程会反复检查锁变量是否可用。因此自旋锁不会让出CPU，是一种忙等待状态。所以自旋锁本质上是一种等待锁被释放的死循环。
   
   2. 特点
      
      1. 自旋锁避免了进程或线程上下文切换的开销
      
      2. 操作系统内部很多地方都使用的自旋锁
      
      3. 自旋锁不适合在单CPU使用

3. #### 读写锁
   
   1. 定义
      
      在实际业务中，临界资源一般是处于多读少写的状态中。如果使用互斥量或者自旋锁时，某个进程对一个临界资源只是进行读取，那么其他进程也无法对其进行读操作，造成资源的浪费。
      
      读写锁是一种特殊的自旋锁，允许多个读操作同时操作以提高资源利用效率。但是对于写操作是互斥的。

4. #### 条件变量
   
   - 条件变量是一种相对复杂的线程同步方法
   
   - 条件变量允许线程睡眠，直到满足某种条件
   
   - 当满足条件时，可以向线程发送信号，通知唤醒
   
   在消费生产模型中，是可能出现缓冲区中资源等于0或者大于缓冲区存储量的情况，这种情况下，必须使生产或消费者一方等待至满足条件时再将其唤醒。由于条件变量并不是锁机制，所以一般配合互斥量一起使用。
