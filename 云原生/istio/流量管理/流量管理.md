# 流量管理

## 请求路由和流量转移
基于请求头，uri等7层规则，将访问某host的流量路由到指定服务中

## 网络弹性
1. 超时
2. 重试
3. 熔断器

## 调试能力
1. 故障注入
2. 流量镜像

## 服务熔断
1. 定义：当下游服务器因为访问压力过大而调用失败或者变慢，上游服务为了保护整个系统调用的可靠性，可以暂时切断对下游服务的调用
2. 开启熔断：在固定时间窗口内，接口调用超时比率达到一定的阈值，就会开启熔断。进入熔断状态后，后续对该接口的调用不经过网络，而是直接执行本地默认方法。达到服务降级功能。
3. 熔断恢复：经过了规定时间后
4. 实践：hystrix三种状态实现熔断机制
   1. 熔断状态关闭close：没有任何故障时，熔断器所处的状态，对调用方无限制
   2. 熔断开启状态open：在固定的时间窗口内(默认为10s)，接口调用超时率达到一个阈值(默认为50)，会进入熔断开启状态。后续对该服务的调用会直接执行fallback方法
   3. 半熔断状态half-open：在进入熔断开启状态一段时间(默认为5s)，熔断器会进入半熔断状态，允许有限的流量调用。如果成功率达到预期，则进入开启状态，否则进去关闭状态