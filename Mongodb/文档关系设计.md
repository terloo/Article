# 文档关系设计

内嵌文档：直接将文档内嵌进另一篇文档

规范式文档：不直接内嵌文档，而是内嵌文档的主键

1. #### 一对一关系关系
   
   1. 内嵌文档
      
      1. 一次查询就能返回所有数据
      
      2. 更具独立性的数据应当作为顶层文档
      
      3. 补充性数据应作为内嵌文档

2. #### 一对多关系
   
   1. 内嵌文档
      
      1. 一次查询就能返回所有数据
      
      2. 更新内嵌文档的复杂度增高
      
      3. 适合读取评率远高于更新评率的数据
   
   2. 规范式文档
      
      1. 减少了重复数据
      
      2. 降低了文档更新的复杂度
      
      3. 需要多次读取操作才能得到完整的数据
   
   3. 内嵌数组文档
      
      1. 适合常常需要返回全部相关文档的查询
      
      2. 数组元素较多（百）时，避免使用内嵌数组文档，转而使用规范数组文档
   
   4. 规范数组文档
      
      1. 数组元素极多（千万）时，应使用规范式文档。

3. #### 树形结构关系
   
   1. 保存一个指向父节点的字段
      
      1. 适用于常常需要基于父节点的值查询子节点
      
      2. 紧邻的两个层次关系
   
   2. 保存一个指向子节点的数组字段
      
      1. 适用于常常需要基于子节点的值来查询父节点
      
      2. 紧邻的两个层次关系
   
   3. 保存一个指向所有祖先节点的数组字段
      
      1. 方便搜索祖先节点下面的所有子节点
      
      2. 存储的数据会变多


