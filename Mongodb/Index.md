# Index

1. #### 索引的操作
   
   1. db.collection.createIndex()
      
      1. 定义
         
         ```js
         db.collection.createIndex(<keys>, <options>)
         ```
         
         > keys:指定了需要创建索引的字段，可以声明正负向排序。
      
      2. 选项
         
         | 选项                 | 值       | 说明                           |
         | ------------------ | ------- | ---------------------------- |
         | unique             | boolean | 为true时，为文档添加唯一性，默认为false     |
         | sparse             | boolean | 为true时，为索引添加稀疏性，默认为false     |
         | expireAfterSeconds | int     | 自动删除（现在时间 - 指定字段时间）> 指定秒数的文档 |
   
   2. db.collection.dropIndex()
      
      1. 定义
         
         ```js
         db.collection.dropIndex("索引名" | <索引定义>)
         ```
         
         > 如果要更改某些字段上已经创建的索引，必须先删除原有索引再重新创建索引。

2. #### 索引的分类
   
   1. 单键索引
      
      只对一个字段创建索引，每个文档都会拥有一个主键索引。键名自动生成。
   
   2. 复合键索引
      
      对多个字段创建索引，遵循最左匹配原则。
   
   3. 多键索引
      
      当创建索引的字段包含数组字段时，创建的索引就是多键索引。多键索引会将数组中每一个元素都进行排序，每个元素都有地址指向它所属的文档。

3. #### 索引的特性
   
   1. 唯一性
      
      索引的值在集合中重复时。如果集合这个字段已经存在重复值时便无法创建。只有第一篇缺失该字段的文档可以被写入数据库，索引中该文档的键值被默认为null（即null也无法写入）。
   
   2. 稀疏性
      
      只将包含索引建字段的文档添加进索引中。对于复合键索引，只有包含的所有字段都缺失时，文档才不会被写入集合。**通常与唯一性共同使用**。
   
   3. 生存时间
      
      针对日期字段，或者包含日期元素的数组字段，可以设定生存时间的索引，来自动删除字段值超过生存时间的文档。不能使用在复合键上。当字段为包含时间元素的数组字段时，数组中**最小**的日期将会被用来计算文档是否过期。数据库使用一个后台线程来监视和删除文档，删除操作可能会有延迟，不能用于精确操作。
